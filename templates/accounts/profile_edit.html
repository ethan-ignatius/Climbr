{% extends "base.html" %}
{% block title %}Edit Profile{% endblock %}
{% block content %}
  <div class="card" style="max-width:800px; margin:0 auto;">
    <h1>Edit Your Profile</h1>

    <form method="post">
      {% csrf_token %}
      <div class="form-grid" style="grid-template-columns:1fr;">

        <div class="field">
          {{ form.experience_level.label_tag }}
          {{ form.experience_level }}
          {% if form.experience_level.errors %}
            <ul class="errorlist" role="alert">
              {% for error in form.experience_level.errors %}<li>{{ error }}</li>{% endfor %}
            </ul>
          {% endif %}
          <p class="field-help">{{ form.experience_level.help_text }}</p>
        </div>

        <div class="field">
          {{ form.bio.label_tag }}
          {{ form.bio }}
          {% if form.bio.errors %}
            <ul class="errorlist" role="alert">
              {% for error in form.bio.errors %}<li>{{ error }}</li>{% endfor %}
            </ul>
          {% endif %}
          <p class="field-help">{{ form.bio.help_text }}</p>
        </div>

        <div class="field">
          {{ form.email.label_tag }}
          {{ form.email }}
          {% if form.email.errors %}
            <ul class="errorlist" role="alert">
              {% for error in form.email.errors %}<li>{{ error }}</li>{% endfor %}
            </ul>
          {% endif %}
          <p class="field-help">{{ form.email.help_text }}</p>
        </div>

        <div class="field">
          {{ form.location_name.label_tag }}
          {{ form.location_name }}
          {% if form.location_name.errors %}
            <ul class="errorlist" role="alert">
              {% for error in form.location_name.errors %}<li>{{ error }}</li>{% endfor %}
            </ul>
          {% endif %}
        </div>

        {{ form.latitude }}
        {{ form.longitude }}

        <p style="margin-top:14px;">
          <button class="btn" type="submit">Save Changes</button>
          <button type="button" class="btn" style="margin-left: 0.5rem;" onclick="window.location.href='{% url 'accounts:profile' %}'"> Cancel </button>
        </p>
      </div>
    </form>
  </div>

  <script>
    // Optional: Add geolocation functionality similar to signup
    if (navigator.geolocation) {
      const locationInput = document.querySelector('input[name="location_name"]');
      if (locationInput && !locationInput.value) {
        navigator.geolocation.getCurrentPosition(function(position) {
          document.querySelector('input[name="latitude"]').value = position.coords.latitude;
          document.querySelector('input[name="longitude"]').value = position.coords.longitude;
        });
      }
    }
  </script>
{% endblock %}
